# SSHå¯†é‘°èªè­‰å®Œæ•´è¨­ç½®æŒ‡å—

## ðŸ“‹ æº–å‚™å·¥ä½œ

**ä½ éœ€è¦**ï¼š
- Windowsé›»è…¦ï¼ˆä½ çš„é–‹ç™¼æ©Ÿï¼‰
- Linux VPSï¼ˆä½ çš„æœå‹™å™¨ï¼‰
- VPSçš„IPåœ°å€å’Œrootå¯†ç¢¼ï¼ˆæœ€å¾Œä¸€æ¬¡ç”¨å¯†ç¢¼ï¼‰

---

## æ­¥é©Ÿ1ï¼šç”ŸæˆSSHå¯†é‘°å°ï¼ˆä½ çš„é›»è…¦ï¼‰

### Windows PowerShell

```powershell
# æ‰“é–‹ PowerShellï¼ˆä»¥æ™®é€šç”¨æˆ¶åŸ·è¡Œå³å¯ï¼‰

# ç”Ÿæˆå¯†é‘°
ssh-keygen -t ed25519 -C "ä½ çš„éƒµç®±@example.com"

# è¼¸å‡ºç¤ºä¾‹ï¼š
Generating public/private ed25519 key pair.
Enter file in which to save the key (C:\Users\ä½ çš„ç”¨æˆ¶å/.ssh/id_ed25519):
# ðŸ‘† ç›´æŽ¥æŒ‰ Enterï¼ˆä½¿ç”¨é»˜èªä½ç½®ï¼‰

Enter passphrase (empty for no passphrase):
# ðŸ‘† å¯ä»¥è¨­ç½®å¯†ç¢¼ï¼ˆé¡å¤–ä¿è­·ï¼‰æˆ–ç›´æŽ¥æŒ‰Enter

Enter same passphrase again:
# ðŸ‘† å†æ¬¡è¼¸å…¥å¯†ç¢¼æˆ–æŒ‰Enter

# å®Œæˆï¼æœƒç”Ÿæˆå…©å€‹æ–‡ä»¶ï¼š
# C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\id_ed25519     (ç§é‘° - ä¿å¯†)
# C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\id_ed25519.pub (å…¬é‘° - è¦ä¸Šå‚³)
```

**é‡è¦**ï¼š
- **ç§é‘°**ï¼ˆid_ed25519ï¼‰ï¼šæ°¸é ä¸è¦çµ¦åˆ¥äºº
- **å…¬é‘°**ï¼ˆid_ed25519.pubï¼‰ï¼šå¯ä»¥å…¬é–‹ï¼Œè¦è¤‡è£½åˆ°VPS

---

## æ­¥é©Ÿ2ï¼šæŸ¥çœ‹å…¬é‘°å…§å®¹

```powershell
# æŸ¥çœ‹å…¬é‘°
type C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\id_ed25519.pub

# è¼¸å‡ºé¡žä¼¼ï¼š
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAI... ä½ çš„éƒµç®±@example.com
# ðŸ‘† è¤‡è£½æ•´è¡Œï¼ˆå¾žssh-ed25519é–‹å§‹åˆ°éƒµç®±çµæŸï¼‰
```

**æˆ–ä½¿ç”¨è¨˜äº‹æœ¬æ‰“é–‹**ï¼š
```powershell
notepad C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\id_ed25519.pub
# è¤‡è£½å…¨éƒ¨å…§å®¹
```

---

## æ­¥é©Ÿ3ï¼šä¸Šå‚³å…¬é‘°åˆ°VPS

### æ–¹æ³•Aï¼šä½¿ç”¨ssh-copy-idï¼ˆæŽ¨è–¦ï¼Œå¦‚æžœæœ‰çš„è©±ï¼‰

```powershell
# Windowså¯èƒ½éœ€è¦å…ˆå®‰è£OpenSSH
ssh-copy-id root@ä½ çš„VPS_IP

# è¼¸å…¥VPSå¯†ç¢¼
# è‡ªå‹•å®Œæˆï¼
```

### æ–¹æ³•Bï¼šæ‰‹å‹•è¤‡è£½ï¼ˆé€šç”¨æ–¹æ³•ï¼‰

**3.1 ç™»å…¥VPS**ï¼ˆæœ€å¾Œä¸€æ¬¡ç”¨å¯†ç¢¼ï¼‰
```powershell
ssh root@ä½ çš„VPS_IP
# è¼¸å…¥å¯†ç¢¼
```

**3.2 åœ¨VPSä¸ŠåŸ·è¡Œ**
```bash
# å‰µå»º.sshç›®éŒ„
mkdir -p ~/.ssh

# ç·¨è¼¯authorized_keys
nano ~/.ssh/authorized_keys

# è²¼ä¸Šå‰›æ‰è¤‡è£½çš„å…¬é‘°ï¼ˆæ•´è¡Œï¼‰
# Ctrl+O ä¿å­˜
# Ctrl+X é€€å‡º

# è¨­ç½®æ­£ç¢ºçš„æ¬Šé™ï¼ˆé‡è¦ï¼ï¼‰
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys

# æª¢æŸ¥å…§å®¹
cat ~/.ssh/authorized_keys
# æ‡‰è©²çœ‹åˆ°ä½ çš„å…¬é‘°
```

---

## æ­¥é©Ÿ4ï¼šæ¸¬è©¦SSHå¯†é‘°ç™»å…¥

**é€€å‡ºVPS**
```bash
exit
```

**é‡æ–°ç™»å…¥ï¼ˆä¸éœ€å¯†ç¢¼ï¼‰**
```powershell
ssh root@ä½ çš„VPS_IP

# å¦‚æžœæˆåŠŸï¼šç›´æŽ¥ç™»å…¥ï¼Œä¸è¦æ±‚å¯†ç¢¼ âœ…
# å¦‚æžœå¤±æ•—ï¼šé‚„æ˜¯è¦æ±‚å¯†ç¢¼ï¼Œéœ€è¦æª¢æŸ¥æ¬Šé™
```

**å¦‚æžœå¤±æ•—ï¼Œæª¢æŸ¥VPSä¸Šçš„æ¬Šé™**ï¼š
```bash
ls -la ~/.ssh
# æ‡‰è©²é¡¯ç¤ºï¼š
# drwx------ .ssh
# -rw------- authorized_keys
```

---

## æ­¥é©Ÿ5ï¼šç¦ç”¨å¯†ç¢¼ç™»å…¥ï¼ˆå¼·çƒˆå»ºè­°ï¼‰

**âš ï¸ ç¢ºèªæ­¥é©Ÿ4æˆåŠŸå¾Œæ‰åŸ·è¡Œ**

```bash
# åœ¨VPSä¸ŠåŸ·è¡Œ
sudo nano /etc/ssh/sshd_config

# æ‰¾åˆ°ä¸¦ä¿®æ”¹ä»¥ä¸‹è¡Œï¼ˆåŽ»æŽ‰#è¨»é‡‹ï¼‰ï¼š
PasswordAuthentication no
PubkeyAuthentication yes
ChallengeResponseAuthentication no

# ä¿å­˜ä¸¦é€€å‡º
# Ctrl+O, Enter, Ctrl+X

# é‡å•ŸSSHæœå‹™
sudo systemctl restart sshd
```

**æ¸¬è©¦**ï¼š
```powershell
# é€€å‡ºVPS
exit

# é‡æ–°ç™»å…¥
ssh root@ä½ çš„VPS_IP
# æ‡‰è©²é‚„æ˜¯ç›´æŽ¥ç™»å…¥ âœ…
```

**å¾žå¦ä¸€å°é›»è…¦æ¸¬è©¦**ï¼ˆå¯é¸ï¼‰ï¼š
```
# ç”¨å¦ä¸€å°é›»è…¦å˜—è©¦ç™»å…¥
ssh root@ä½ çš„VPS_IP
# æ‡‰è©²ç›´æŽ¥æ‹’çµ•ï¼Œä¸çµ¦è¼¸å¯†ç¢¼çš„æ©Ÿæœƒ âœ…
```

---

## ðŸ“± å¤šå°é›»è…¦è¨­ç½®

å¦‚æžœä½ æœ‰å¤šå°é›»è…¦éœ€è¦è¨ªå•VPSï¼š

**é¸é …Aï¼šè¤‡è£½ç§é‘°ï¼ˆä¸æŽ¨è–¦ï¼‰**
```
æŠŠ id_ed25519 è¤‡è£½åˆ°å¦ä¸€å°é›»è…¦
```

**é¸é …Bï¼šæ¯å°é›»è…¦ç”Ÿæˆè‡ªå·±çš„å¯†é‘°ï¼ˆæŽ¨è–¦ï¼‰**
```bash
# æ¯å°é›»è…¦ï¼š
1. ç”Ÿæˆè‡ªå·±çš„å¯†é‘°å°
2. æŠŠå…¬é‘°æ·»åŠ åˆ°VPS

# VPSä¸Šï¼š
cat >> ~/.ssh/authorized_keys << EOF
é›»è…¦1çš„å…¬é‘°
é›»è…¦2çš„å…¬é‘°
é›»è…¦3çš„å…¬é‘°
EOF
```

---

## ðŸ”§ å¸¸è¦‹å•é¡Œ

### 1. å¿˜è¨˜ä¿å­˜ç§é‘°å‚™ä»½

**ç—‡ç‹€**ï¼šé›»è…¦é‡è£å¾Œç„¡æ³•ç™»å…¥VPS

**è§£æ±º**ï¼š
1. ä½¿ç”¨VPSæŽ§åˆ¶å°ç™»å…¥ï¼ˆé›²æœå‹™å•†å¾Œå°ï¼‰
2. é‡æ–°è¨­ç½®authorized_keys
3. æˆ–æš«æ™‚å•Ÿç”¨å¯†ç¢¼ç™»å…¥

**é é˜²**ï¼š
```powershell
# å‚™ä»½ç§é‘°
copy C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\id_ed25519 D:\backup\
# ä¿å­˜åˆ°å®‰å…¨çš„åœ°æ–¹ï¼ˆUSBã€åŠ å¯†é›²ç«¯ï¼‰
```

### 2. æ¬Šé™éŒ¯èª¤

**ç—‡ç‹€**ï¼šé‚„æ˜¯è¦æ±‚å¯†ç¢¼

**æª¢æŸ¥VPSæ—¥èªŒ**ï¼š
```bash
sudo tail -f /var/log/auth.log
# çœ‹æ˜¯å¦æœ‰permission deniedéŒ¯èª¤
```

**ä¿®æ­£æ¬Šé™**ï¼š
```bash
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
chown -R $USER:$USER ~/.ssh
```

### 3. å¤šå€‹å¯†é‘°ç®¡ç†

**Windowsä¸Šä½¿ç”¨configæ–‡ä»¶**ï¼š
```powershell
# å‰µå»ºconfig
notepad C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\config

# å…§å®¹ï¼š
Host vps1
    HostName 123.45.67.89
    User root
    IdentityFile ~/.ssh/id_ed25519

Host vps2
    HostName 98.76.54.32
    User root
    IdentityFile ~/.ssh/id_ed25519_vps2

# ä½¿ç”¨ï¼š
ssh vps1  # è‡ªå‹•ä½¿ç”¨å°æ‡‰å¯†é‘°
```

---

## ðŸ›¡ï¸ å®‰å…¨æœ€ä½³å¯¦è¸

### 1. ç§é‘°ä¿è­·
```powershell
# Windowsï¼šè¨­ç½®æ–‡ä»¶æ¬Šé™
icacls C:\Users\ä½ çš„ç”¨æˆ¶å\.ssh\id_ed25519 /inheritance:r /grant:r "%username%:F"
```

### 2. ä½¿ç”¨å¯†ç¢¼ä¿è­·ç§é‘°
```
ç”Ÿæˆå¯†é‘°æ™‚è¨­ç½®passphrase
å³ä½¿ç§é‘°è¢«ç›œï¼Œæ²’æœ‰å¯†ç¢¼ä¹Ÿç„¡æ³•ä½¿ç”¨
```

### 3. å®šæœŸè¼ªæ›
```
æ¯å¹´ç”Ÿæˆæ–°å¯†é‘°å°
æ’¤éŠ·èˆŠå¯†é‘°
```

### 4. ç›£æŽ§ç™»å…¥
```bash
# VPSä¸Šå®šæœŸæª¢æŸ¥
sudo lastlog
sudo last
```

---

## âœ… å®Œæˆæª¢æŸ¥æ¸…å–®

- [ ] ç”ŸæˆSSHå¯†é‘°å°
- [ ] å…¬é‘°ä¸Šå‚³åˆ°VPS
- [ ] æ¸¬è©¦å¯†é‘°ç™»å…¥æˆåŠŸ
- [ ] ç¦ç”¨å¯†ç¢¼ç™»å…¥
- [ ] å‚™ä»½ç§é‘°åˆ°å®‰å…¨ä½ç½®
- [ ] å¾žå¦ä¸€å€‹IPæ¸¬è©¦ï¼ˆç¢ºèªå¯†ç¢¼å·²ç¦ç”¨ï¼‰

---

## ðŸŽ¯ æ•ˆæžœå°æ¯”

### ä½¿ç”¨å¯†ç¢¼å‰
```
é§­å®¢æ¯å¤©å˜—è©¦ï¼š
2025-12-30 01:23 Failed password for root from 1.2.3.4
2025-12-30 01:24 Failed password for root from 1.2.3.4
2025-12-30 01:25 Failed password for root from 1.2.3.4
... (æ•¸ç™¾æ¬¡)
```

### ä½¿ç”¨SSHå¯†é‘°å¾Œ
```
é§­å®¢å˜—è©¦ï¼š
Connection refused (publickey)
Connection refused (publickey)
â†’ æ”¾æ£„ âœ…
```

**ä½ çš„VPSæ—¥èªŒæœƒå®‰éœå¾ˆå¤šï¼**

---

## ç¸½çµ

**SSHå¯†é‘° = VPSçš„ç¬¬ä¸€é“é˜²ç·š**

å®Œæˆå¾Œï¼ŒVPSå®‰å…¨æ€§æå‡90%ï¼Œçµåˆå‰é¢çš„ï¼š
1. âœ… Binance API IPç™½åå–®
2. âœ… ç¦ç”¨æç¾æ¬Šé™  
3. âœ… SSHå¯†é‘°èªè­‰

**ä½ çš„ç³»çµ±å°‡éžå¸¸å®‰å…¨ï¼** ðŸ”’

éœ€è¦å¹«åŠ©ï¼Ÿé‡åˆ°å•é¡Œï¼Ÿéš¨æ™‚å•æˆ‘ï¼
